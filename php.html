<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<title>getXML</title>
<style>
.datalist{
    border:1px solid #744011; 
    font-family:Arial;
    border-collapse:collapse;
    background-color:#ffd2aa;
    font-size:14px;
}
.datalist th{
    border:1px solid #744011;    
    background-color:#a16128;
    color:#FFFFFF;                
    font-weight:bold;
    padding-top:4px; padding-bottom:4px;
    padding-left:12px; padding-right:12px;
    text-align:center;
}
.datalist td{
    border:1px solid #744011;   
    text-align:left;
    padding-top:4px; padding-bottom:4px;
    padding-left:10px; padding-right:10px;
}
.datalist tr:hover, .datalist tr.altrow{
    background-color:#dca06b;   
}
input{
    border:1px solid #744011;
    color:#744011;
}
</style>
<script>
var xmlHttp;
 /* 兼容实例化XMLHttpRequest
 */
function createXMLHttpRequest(){
    if(window.ActiveXObject)
        xmlHttp = new ActiveXObject("Microsoft.XMLHttp");
    else if(window.XMLHttpRequest)
        xmlHttp = new XMLHttpRequest();
}
 /* 获取后台内容
 * @param  {string} addressXML XML地址
 */
function getXML(addressXML){
    var url = addressXML + "?timestamp=" + new Date();
    createXMLHttpRequest();
    xmlHttp.onreadystatechange = handleStateChange;
    xmlHttp.open("GET",url);
    xmlHttp.send(null);
}
 /* DOM方法添加内容到表格
 * @param  {string} sName  姓名
 * @param  {string} sClass 班级
 * @param  {string} sBirth 出生日期
 */
function addTableRow(sName, sClass, sBirth){
    var oTable = document.getElementById("member");
    var oTr = oTable.insertRow(oTable.rows.length);   
    var aText = new Array();
    aText[0] = document.createTextNode(sName);
    aText[1] = document.createTextNode(sClass);
    aText[2] = document.createTextNode(sBirth);
    for(var i=0;i<aText.length;i++){
        var oTd = oTr.insertCell(i);
        oTd.appendChild(aText[i]);
    }
}
 /* 用DOM方法操作XML文档
 * @param  {object} myXML 要处理的xml文档
 */
function DrawTable(myXML){
    var oMembers = myXML.getElementsByTagName("member");
    var oMember = "", sName = "", sClass = "", sBirth = "";
    for(var i=0;i<oMembers.length;i++){
        oMember = oMembers[i];
        sName = oMember.getElementsByTagName("name")[0].firstChild.nodeValue;
        sClass = oMember.getElementsByTagName("class")[0].firstChild.nodeValue;
        sBirth = oMember.getElementsByTagName("birth")[0].firstChild.nodeValue;
        addTableRow(sName, sClass, sBirth);
    }
}
 /* 变化处理函数
 */
function handleStateChange(){   
    if(xmlHttp.readyState == 4 && xmlHttp.status == 200)
        DrawTable(xmlHttp.responseXML);
}
</script>
</head>
 
<body>
<input type="button" value="获取XML" onclick="getXML('xml.xml');"><br><br>
<table class="datalist" summary="list of members in EE Studay" id="member">
    <tr>
        <th scope="col">Name</th>
        <th scope="col">Class</th>
        <th scope="col">Birthday</th>
    </tr>
</table>
</body>
</html>